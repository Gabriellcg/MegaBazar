<div class="cart-container">

  <header class="header">
    <div class="container">
      <div class="header-content">
        <h1 class="logo" [routerLink]="['/']">MegaLoja Online</h1>
        <div class="header-icons">
          <button class="icon-btn">üë§</button>
          <button class="icon-btn" [routerLink]="['/meus-pedidos']" title="Meus Pedidos">üì¶
          </button>
          <button class="icon-btn cart-active">üõí</button>
        </div>
      </div>
    </div>
  </header>


  <main class="main-content">
    <div class="container">

      <h1 class="page-title">Meu carrinho</h1>


      <div *ngIf="itens.length === 0" class="empty-cart">
        <div class="empty-icon">üõí</div>
        <h2>Seu carrinho est√° vazio</h2>
        <p>Adicione produtos ao carrinho para continuar comprando</p>
        <button class="btn-primary" (click)="continuarComprando()">
          Ver Produtos
        </button>
      </div>

      <div *ngIf="itens.length > 0" class="cart-content">

        <div class="cart-items">
          <div class="cart-header-actions">
            <span class="items-count">{{ itens.length }} {{ itens.length === 1 ? 'item' : 'itens' }}</span>
            <button class="btn-clear" (click)="limparCarrinho()">
              Limpar carrinho
            </button>
          </div>

          <div class="item-card" *ngFor="let item of itens" [class.item-erro-estoque]="temErroEstoque(item.produto.id)"
            [class.item-aviso-estoque]="temAvisoEstoque(item.produto.id)">

            <div class="item-image" (click)="irParaProduto(item.produto.id)">
              <img [src]="item.produto.imagem" [alt]="item.produto.nome">
            </div>

            <div class="item-info">
              <h3 class="item-name" (click)="irParaProduto(item.produto.id)">
                {{ item.produto.nome }}
              </h3>

              <div class="item-price-section">
                <p class="item-price">
                  R$ {{ formatarNumero(item.produto.preco) }}
                </p>
                <p class="item-installments">
                  {{ item.produto.parcelas }}x de R$ {{ formatarNumero(calcularParcela(item.produto.preco,
                  item.produto.parcelas)) }}
                </p>
              </div>

              <div class="estoque-container" *ngIf="getMensagemEstoque(item.produto.id)">
                <div class="estoque-badge" [class.estoque-erro]="temErroEstoque(item.produto.id)"
                  [class.estoque-aviso]="temAvisoEstoque(item.produto.id)">
                  <span class="estoque-icon">
                    {{ temErroEstoque(item.produto.id) ? '‚ö†Ô∏è' : '‚ÑπÔ∏è' }}
                  </span>
                  <span class="estoque-texto">
                    {{ getMensagemEstoque(item.produto.id) }}
                  </span>
                </div>
              </div>

              <div class="item-actions">
                <div class="quantity-control">
                  <button class="qty-btn" (click)="diminuirQuantidade(item)" [disabled]="item.quantidade <= 1">
                    -
                  </button>
                  <span class="qty-value">{{ item.quantidade }}</span>
                  <button class="qty-btn" (click)="aumentarQuantidade(item)"
                    [disabled]="item.quantidade >= item.produto.estoque || item.quantidade >= 10">
                    +
                  </button>
                  <span class="estoque-disponivel">
                    ({{ item.produto.estoque }} {{ item.produto.estoque === 1 ? 'dispon√≠vel' : 'dispon√≠veis' }})
                  </span>
                </div>

                <button class="btn-remove" (click)="removerItem(item)">
                  üóëÔ∏è Remover
                </button>
              </div>
            </div>

            <div class="item-subtotal">
              <span class="subtotal-label">Subtotal:</span>
              <span class="subtotal-value">
                R$ {{ formatarNumero(item.produto.preco * item.quantidade) }}
              </span>
            </div>
          </div>
        </div>

        <div class="order-summary">
          <div class="summary-card">
            <h2 class="summary-title">Resumo do pedido</h2>

            <div class="summary-line">
              <span>Subtotal ({{ itens.length }} {{ itens.length === 1 ? 'item' : 'itens' }}):</span>
              <span>R$ {{ formatarNumero(subtotal) }}</span>
            </div>

            <div class="summary-line">
              <span>Frete:</span>
              <span [class.free-shipping]="frete === 0">
                {{ frete === 0 ? 'GR√ÅTIS' : 'R$ ' + formatarNumero(frete) }}
              </span>
            </div>

            <div class="summary-divider"></div>

            <div class="summary-total">
              <span>Total:</span>
              <span class="total-value">R$ {{ formatarNumero(total) }}</span>
            </div>

            <div class="free-shipping-info" *ngIf="subtotal > 0 && subtotal < 200">
              <p class="info-icon">‚ÑπÔ∏è</p>
              <p>Falta R$ {{ formatarNumero(200 - subtotal) }} para frete gr√°tis!</p>
            </div>

            <div class="free-shipping-success" *ngIf="frete === 0 && subtotal > 0">
              <p class="success-icon">‚úì</p>
              <p>Voc√™ ganhou frete gr√°tis!</p>
            </div>

            <div class="checkout-warning" *ngIf="!podeFinalizarCompra() && itens.length > 0">
              <p class="warning-icon">‚ö†Ô∏è</p>
              <p class="warning-text">
                Ajuste as quantidades dos produtos com estoque insuficiente antes de finalizar
              </p>
            </div>

            <button class="btn-checkout" (click)="finalizarCompra()" [disabled]="!podeFinalizarCompra()"
              [class.btn-disabled]="!podeFinalizarCompra()">
              {{ podeFinalizarCompra() ? 'Finalizar compra' : 'Verifique o estoque' }}
            </button>

            <button class="btn-continue" (click)="continuarComprando()">
              Continuar comprando
            </button>


            <div class="payment-info">
              <p class="payment-title">Formas de pagamento:</p>
              <div class="payment-icons">
                <span class="payment-icon">üí≥</span>
                <span class="payment-icon">üè¶</span>
                <span class="payment-icon">üì±</span>
                <span class="payment-icon">üé´</span>
              </div>
              <p class="payment-text">
                Cart√£o de cr√©dito, d√©bito, PIX, boleto e mais
              </p>
            </div>


            <div class="security-info">
              <p>üîí Ambiente seguro</p>
              <p>Seus dados est√£o protegidos</p>
            </div>
          </div>
        </div>

      </div>

    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-col">
          <h3>Sobre N√≥s</h3>
          <p>A melhor loja online com os melhores pre√ßos.</p>
        </div>
        <div class="footer-col">
          <h3>Atendimento</h3>
          <p>Segunda a Sexta: 8h √†s 18h<br>S√°bado: 8h √†s 12h</p>
        </div>
        <div class="footer-col">
          <h3>Contato</h3>
          <p>contato@megaloja.com<br>(11) 1234-5678</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>¬© 2024 MegaLoja Online. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>

</div>